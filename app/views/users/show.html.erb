<% full_name = "#{@user.fname} #{@user.lname}" %>
<% provide(:title, full_name) %>
<h1>
  <%= "#{@user.fname} #{@user.lname}" %>
</h1>

<% if flash[:notice] %>
  <p id="notice"><%= flash[:notice] %></p>
<% end %>
<div class="dash-menu">
  <%= button_to "Home", root_path, :class => "menu-btn", :method => :get%>
  <% if (current_user.admin || @user == current_user)  %>
  <%= button_to "Edit this profile", edit_user_path(@user), :class => "menu-btn", :method => :get%>
  <% end %>
  <%= button_to "All WynAlums", user_index_path, :class => "menu-btn", :method => :get%>
  <%= button_to "All Cohorts", cohort_index_path, :class => "menu-btn", :method => :get%>
  <%= button_to "Employers", companies_path, :class => "menu-btn", :method => :get%><br>
</div>
<div class="profile">
  <!-- Basic Info: Start -->
  <div class="profile-basic">
    <h2>Contact Info</h2>
  <p>Name:
    <%= @user.fname %>
    <%= @user.lname %></p>
  <p>Email:
    <%= mail_to @user.email %></p>
  <p>Location:
    <%= @user.location %></p>
  <p>Status:
    <% if @user.status["seeking"] == "true" %>
    <%= "Looking" %>
    <% else %>
    <%= "Not Looking" %>
    (<%= @user.status["reason"] %>)
    <% end %></p>
    </div>
    <!-- Social Info: End -->
    <div class="profile-social">
      <h2>Social links</h2>
    <p>Github:
      <%if @user.social_links.empty? %>
      <%=""%>
      <%else%>
      <%= link_to @user.social_links["github"],@user.social_links["github"]  %></p>
      <%end%>
    <p>LinkedIn:
      <%if @user.social_links.empty? %>
      <%=""%>
      <%else%>
      <%= link_to @user.social_links["linkedin"], @user.social_links["linkedin"] %></p>
      <%end%>
    <p>Portfolio Site:
      <%= link_to @user.social_links["portfolio"], @user.social_links["portfolio"] %></p>

    <p>Slack:
      <%= @user.social_links["slack"] %></p>
    </div>
    <div class="profile-con">
      <%= image_tag @user.avatar_url(:profile_pic), class: "img-cir" %>
  </div>
</div>

<!-- Basic Info: End -->
<br>
<div class="flat">

<% if current_user.admin || current_user == User.find(params[:id]) %>
<h3>Work History - <%= link_to "Add A Position", employment_new_path(@user) %></span></h3>
<% end %>

<% if current_user.admin %>
  <%= link_to 'Delete This Profile', @user, method: :delete, data: { confirm: 'Are you sure you want to delete this profile?' } %>
<% end %>
</div>
<div class="profile-hist">
<table class="profile-hist-table">
  <thead>
    <tr>
      <th>Company</th>
      <th>Job Title</th>
      <th>Type of Role</th>
      <th>Nature of Role</th>
      <th>Type of Organization</th>
      <th>Source of Offer</th>
      <th>Salary</th>
      <th>Begin</th>
      <th>End</th>
      <th>Current Job</th>
      <% if current_user.admin || current_user == User.find(params[:id]) %>
        <th>Edit</th>
      <% end %>

    </tr>
  </thead>
  <tbody>
    <% @employments.each do |employment| %>


    <tr>
      <td><%= link_to employment.company.name, company_path(employment.company) %></td>
      <td><%= employment.jobtitle %></td>
      <td><%= employment.roletype %></td>
      <td><%= employment.rolenature %></td>
      <td><%= employment.company.orgtype %></td>
      <td><%= employment.rolesource %></td>
      <td><%= number_to_currency(employment.salary, precision: 0) %></td>
      <td><%= employment.start_date %></td>
      <td><%= if !employment.end_date.nil?
          employment.end_date
        end %></td>
      <td><% if employment.current %>
          <%= "Yes" %>
        <% end %></td>

      <% if current_user.admin || current_user == User.find(params[:id]) %>
          <td>
          <%= link_to 'edit', employment_edit_path(employment) %>/
          <%= link_to 'delete', employment_destroy_path(employment), method: :delete %>
          </td>
      <% end %>

        <% end %>
      </tbody>
    </table>
  </div>
<!-- <%# image_tag @user.avatar_url( or avatar.url) if @user.avatar?%> -->
